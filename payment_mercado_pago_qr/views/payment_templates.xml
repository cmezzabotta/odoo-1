<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <template id="mercado_pago_qr_button" inherit_id="payment.payment_provider_template">
        <xpath expr="//div[contains(@class, 'o_payment_provider_options')]" position="inside">
            <div class="o_payment_provider" t-att-data-provider-code="provider.code" t-if="provider.code == 'mercado_pago_qr'">
                <label class="o_payment_provider__label" t-att-for="'payment_provider_%s' % provider.id">
                    <input type="radio"
                           t-att-name="radio_name"
                           t-att-checked="provider.is_default and 'checked' or False"
                           t-att-id="'payment_provider_%s' % provider.id"
                           t-att-value="provider.id"/>
                    <span>Mercado Pago QR</span>
                </label>
                <div class="o_payment_provider__description">
                    <p>Escaneá el código QR con tu aplicación de Mercado Pago para completar el pago al instante.</p>
                </div>
            </div>
        </xpath>
    </template>

    <template id="mercado_pago_qr_form" inherit_id="payment.payment_checkout_form">
        <xpath expr="//div[@id='o_payment_provider_content']" position="inside">
            <t t-if="provider_code == 'mercado_pago_qr'">
                <div class="o_mercado_pago_qr_panel" data-mp-qr-url="" t-att-data-status-url="api_url">
                    <h3>Pagá con Mercado Pago</h3>
                    <div class="o_mercado_pago_qr_image">
                        <t t-if="mercado_pago_qr_image">
                            <img t-att-src="'data:image/png;base64,%s' % mercado_pago_qr_image" alt="Mercado Pago QR"/>
                        </t>
                        <t t-else="">
                            <div class="o_mercado_pago_qr_canvas" t-att-data-qr="mercado_pago_qr_data"></div>
                        </t>
                    </div>
                    <p class="o_mercado_pago_qr_instructions">
                        Escaneá el código con la app de Mercado Pago o con la cámara de tu celular. Tu pedido se confirmará automáticamente cuando el pago se acredite.
                    </p>
                    <div class="o_mercado_pago_qr_status" role="status"></div>
                </div>
            </t>
        </xpath>
    </template>
</odoo>
